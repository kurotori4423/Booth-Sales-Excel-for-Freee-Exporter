# Booth Sales Excel for Freee Exporter

## 概要
「Booth Sales Excel for Freee Exporter」は、Boothの売上詳細ページからデータを抽出し、Freeeにインポート可能なExcelファイル（.xlsx形式）を自動生成・ダウンロードするChrome拡張機能です。
ChatGPTを使用して作成されました。

## 特徴
- **データ抽出:**  
  Boothの売上詳細ページ内、`co-expansion-panel js-accordion-content u-pt-300 u-pb-300` クラスの要素から注文番号、注文日時、小計、手数料を抽出します。
  
- **Excelファイル生成:**  
  抽出したデータをもとに、収入と手数料の2行形式でExcelファイルを生成します。ファイル名にはページタイトルが使用され、Freeeへのインポートが可能な形式に整形されています。

- **対象ページ限定:**  
  拡張機能は `https://manage.booth.pm/sales/{年}/{月}` の形式のURLのページでのみ動作し、その他のページではボタンを表示しません。

- **ユーザーフレンドリー:**  
  ページ左下に固定配置された「Excelエクスポート」ボタンをクリックするだけで、Excelファイルのダウンロードが開始されます。

以下は、1件の注文データに基づいて生成されるExcelファイルの例です。
備考欄には注文番号が入ります。

| 収支区分 | 発生日      | 勘定科目   | 税区分        | 金額  | 取引先 | 備考      |
|----------|-------------|------------|---------------|-------|--------|-----------|
| 収入     | 2024/02/02  | 売上高     | 課対仕入10%   | 6000  | Booth  | 43709438  |
|          |             | 支払手数料 | 課対仕入10%   | -358  | Booth  |           |

例えば、複数件の注文がある場合は、以下のように複数の行が追加されます。

| 収支区分 | 発生日      | 勘定科目   | 税区分        | 金額  | 取引先 | 備考      |
|----------|-------------|------------|---------------|-------|--------|-----------|
| 収入     | 2024/02/02  | 売上高     | 課対仕入10%   | 6000  | Booth  | 43709438  |
|          |             | 支払手数料 | 課対仕入10%   | -358  | Booth  |           |
| 収入     | 2024/02/03  | 売上高     | 課対仕入10%   | 1000  | Booth  | 43724098  |
|          |             | 支払手数料 | 課対仕入10%   | -78   | Booth  |           |

## インストール方法
1. このリポジトリをクローンまたはZIPでダウンロードします。
2. Chromeを開き、`chrome://extensions` にアクセスします。
3. 右上の「デベロッパーモード」を有効にします。
4. 「パッケージ化されていない拡張機能を読み込む」ボタンをクリックし、ダウンロードしたフォルダを選択してください。

## 使い方
1. Boothの売上詳細ページ（例: `https://manage.booth.pm/sales/2025/1`）を開きます。
2. ページ左下に「Excelエクスポート」ボタンが表示されます。
3. ボタンをクリックすると、ページからデータが抽出され、Freeeにインポート可能な形式のExcelファイルが自動的に生成・ダウンロードされます。

## 技術情報
- **データ抽出:**  
  拡張機能はページ内の特定のHTML要素から注文情報（注文番号、注文日時、小計、手数料）を抽出します。
  
- **Excel生成:**  
  [SheetJS](https://github.com/SheetJS/sheetjs) のライブラリ（xlsx.full.min.js）を使用してExcelファイルを生成します。  
  ※ ライブラリはローカルファイルとして含めています。

- **URL制御:**  
  拡張機能は、`/sales/{年}/{月}` の形式のURLでのみ動作するように設計されています。  
  正規表現によるチェックにより、対象ページ以外ではボタンが表示されません。

## 注意事項
- Boothのページ構造やURL形式が変更された場合、正しく動作しなくなる可能性があります。その際は、コードの更新が必要です。
- 本拡張機能は個人の利用を目的としており、商用利用や第三者サービスへの無断転載はご遠慮ください。

## ライセンス
本プロジェクトはMITライセンスの下で公開されています。  
詳細は [LICENSE](LICENSE) ファイルをご確認ください。

## 貢献
バグの報告や機能追加の提案は、GitHub上のIssueやPull Requestを通じて歓迎します。  
ご意見・ご提案お待ちしております。
